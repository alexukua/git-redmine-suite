#!/bin/bash

function redmine_set_status
{
    PROGRESS="-1"
    [ "x$2" == "x$REDMINE_REVIEW_TODO" ] && PROGRESS="100"
    if [ "x$4" == "x" ]
    then
        /usr/local/share/Git-Redmine-Suite/helpers/redmine-set-status-id --id="$1" --status_id="$2" --assigned_to_id="$3" --progress="$PROGRESS" --auth_key="$REDMINE_AUTHKEY" --server_url="$REDMINE_URL" 2> /dev/null
    else
        /usr/local/share/Git-Redmine-Suite/helpers/redmine-set-status-id --id="$1" --status_id="$2" --assigned_to_id="$3" --notes="$4" --progress="$PROGRESS" --auth_key="$REDMINE_AUTHKEY" --server_url="$REDMINE_URL" 2> /dev/null
    fi
    if [ $? -ne 0 ]
    then
        echo "Can't change the redmine status of task $1 with value $2 and assigned_to id $3 ..."
        exit 1
    fi
}

